<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lanou.mapper.ContracthiscMapper">
<cache/>
  <resultMap id="BaseResultMap" type="com.lanou.entity.Contracthisc">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jan 05 15:47:01 CST 2018.
    -->
    <id column="CONTRACT_ID" jdbcType="VARCHAR" property="CONTRACT_ID" />
    <result column="OFFEROR" jdbcType="VARCHAR" property="OFFEROR" />
    <result column="CONTRACT_NO" jdbcType="VARCHAR" property="CONTRACT_NO" />
    <result column="SIGNING_DATE" jdbcType="TIMESTAMP" property="SIGNING_DATE" />
    <result column="INPUT_BY" jdbcType="VARCHAR" property="INPUT_BY" />
    <result column="CHECK_BY" jdbcType="VARCHAR" property="CHECK_BY" />
    <result column="INSPECTOR" jdbcType="VARCHAR" property="INSPECTOR" />
    <result column="TOTAL_AMOUNT" jdbcType="DECIMAL" property="TOTAL_AMOUNT" />
    <result column="IMPORT_NUM" jdbcType="DECIMAL" property="IMPORT_NUM" />
    <result column="CREQUEST" jdbcType="VARCHAR" property="CREQUEST" />
    <result column="CUSTOM_NAME" jdbcType="VARCHAR" property="CUSTOM_NAME" />
    <result column="DELIVERY_PERIOD" jdbcType="TIMESTAMP" property="DELIVERY_PERIOD" />
    <result column="SHIP_TIME" jdbcType="TIMESTAMP" property="SHIP_TIME" />
    <result column="TRADE_TERMS" jdbcType="VARCHAR" property="TRADE_TERMS" />
    <result column="REMARK" jdbcType="VARCHAR" property="REMARK" />
    <result column="PRINT_STYLE" jdbcType="CHAR" property="PRINT_STYLE" />
    <result column="OLD_STATE" jdbcType="DECIMAL" property="OLD_STATE" />
    <result column="STATE" jdbcType="DECIMAL" property="STATE" />
    <result column="OUT_STATE" jdbcType="DECIMAL" property="OUT_STATE" />
    <result column="CREATE_BY" jdbcType="VARCHAR" property="CREATE_BY" />
    <result column="CREATE_DEPT" jdbcType="VARCHAR" property="CREATE_DEPT" />
    <result column="CREATE_TIME" jdbcType="TIMESTAMP" property="CREATE_TIME" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jan 05 15:47:01 CST 2018.
    -->
    CONTRACT_ID, OFFEROR, CONTRACT_NO, SIGNING_DATE, INPUT_BY, CHECK_BY, INSPECTOR, TOTAL_AMOUNT, 
    IMPORT_NUM, CREQUEST, CUSTOM_NAME, DELIVERY_PERIOD, SHIP_TIME, TRADE_TERMS, REMARK, 
    PRINT_STYLE, OLD_STATE, STATE, OUT_STATE, CREATE_BY, CREATE_DEPT, CREATE_TIME
  </sql>
  <!-- 查询所有的历史合同 -->
  <select id="selectAll" resultType="com.lanou.bean.ContractBean">
  SELECT t.CONTRACT_ID,
       t.SIGNING_DATE,
       t.CONTRACT_NO,
       t.CUSTOM_NAME,
       t.DELIVERY_PERIOD,
       t.SHIP_TIME,
       t.TOTAL_AMOUNT,
       t.STATE,
       t4.CNUMBER,
       t8.expNum
  from CONTRACT_HIS_C t
  left JOIN (SELECT sum(t3.CNUMBER) as CNUMBER, t2.CONTRACT_ID
               from CONTRACT_HIS_C t2
              inner JOIN CONTRACT_PRODUCT_HIS_C t3
                 on t3.CONTRACT_ID = t2.CONTRACT_ID
              group by t2.CONTRACT_ID) t4
    on t4.CONTRACT_ID = t.CONTRACT_ID
  left JOIN (SELECT sum(t7.CNUMBER) as expNum, t5.CONTRACT_ID
               from CONTRACT_HIS_C t5
              inner JOIN CONTRACT_PRODUCT_HIS_C t6
                 on t6.CONTRACT_ID = t5.CONTRACT_ID
              inner join EXT_CPRODUCT_HIS_C t7
                 on t6.CONTRACT_PRODUCT_ID = t7.CONTRACT_PRODUCT_ID
              group by t5.CONTRACT_ID) t8
    on t8.CONTRACT_ID = t.CONTRACT_ID
  </select>
  
  <!-- 根据合同id查询合同详情 -->
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from CONTRACT_HIS_C
    where CONTRACT_ID = #{CONTRACT_ID,jdbcType=VARCHAR}
  </select>
  <!-- 根据厂家ID查询该厂家下所有的合同信息 -->
  <select id="selectByFactoryName" parameterType="java.lang.String" resultMap="BaseResultMap">
  select distinct t.contract_id,
                t.offeror,
                t.contract_no,
                t.signing_date,
                t.input_by,
                t.check_by,
                t.inspector,
                t.total_amount,
                t.import_num,
                t.crequest,
                t.custom_name,
                t.delivery_period,
                t.ship_time,
                t.trade_terms,
                t.remark,
                t.print_style,
                t.old_state,
                t.state,
                t.out_state,
                t.create_by,
                t.create_dept,
                t.create_time
  from contract_c t
  left join contract_product_c t1
    on t.contract_id = t1.contract_id
 where t1.factory_name = #{factoryName}
  
  </select>
  <!-- 求出总金额最大的合同信息 -->
  <select id="selectByMax" resultMap="BaseResultMap">
  
  select <include refid="Base_Column_List" /> 
   from CONTRACT_HIS_C t where t.total_amount = (
	select max(t1.total_amount) from CONTRACT_C t1
	)
  
  </select>
  <!-- 求近几个月以来,合同列表 -->
  <select id="selectByTime" resultMap="BaseResultMap" parameterType="java.lang.String">
  select <include refid="Base_Column_List" /> 
   from CONTRACT_HIS_C t where t.delivery_period <![CDATA[> ]]> add_months(sysdate,-#{time})
  
  </select>
  <!-- 根据年份查询合同列表 -->
  <select id="selectByYear" resultMap="BaseResultMap" parameterType="java.lang.String">
  select <include refid="Base_Column_List" />
   from CONTRACT_HIS_C t where to_char(t.delivery_period,'YYYY')  like concat(concat('%',#{year}),'%')
  
  
  </select>
  
  
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jan 05 15:47:01 CST 2018.
    -->
    delete from CONTRACT_HIS_C
    where CONTRACT_ID = #{CONTRACT_ID,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.lanou.entity.Contracthisc">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jan 05 15:47:01 CST 2018.
    -->
    insert into CONTRACT_HIS_C (CONTRACT_ID, OFFEROR, CONTRACT_NO, 
      SIGNING_DATE, INPUT_BY, CHECK_BY, 
      INSPECTOR, TOTAL_AMOUNT, IMPORT_NUM, 
      CREQUEST, CUSTOM_NAME, DELIVERY_PERIOD, 
      SHIP_TIME, TRADE_TERMS, REMARK, 
      PRINT_STYLE, OLD_STATE, STATE, 
      OUT_STATE, CREATE_BY, CREATE_DEPT, 
      CREATE_TIME)
    values (#{CONTRACT_ID,jdbcType=VARCHAR}, #{OFFEROR,jdbcType=VARCHAR}, #{CONTRACT_NO,jdbcType=VARCHAR}, 
      #{SIGNING_DATE,jdbcType=TIMESTAMP}, #{INPUT_BY,jdbcType=VARCHAR}, #{CHECK_BY,jdbcType=VARCHAR}, 
      #{INSPECTOR,jdbcType=VARCHAR}, #{TOTAL_AMOUNT,jdbcType=DECIMAL}, #{IMPORT_NUM,jdbcType=DECIMAL}, 
      #{CREQUEST,jdbcType=VARCHAR}, #{CUSTOM_NAME,jdbcType=VARCHAR}, #{DELIVERY_PERIOD,jdbcType=TIMESTAMP}, 
      #{SHIP_TIME,jdbcType=TIMESTAMP}, #{TRADE_TERMS,jdbcType=VARCHAR}, #{REMARK,jdbcType=VARCHAR}, 
      #{PRINT_STYLE,jdbcType=CHAR}, #{OLD_STATE,jdbcType=DECIMAL}, #{STATE,jdbcType=DECIMAL}, 
      #{OUT_STATE,jdbcType=DECIMAL}, #{CREATE_BY,jdbcType=VARCHAR}, #{CREATE_DEPT,jdbcType=VARCHAR}, 
      #{CREATE_TIME,jdbcType=TIMESTAMP})
  </insert>
  <insert id="insertSelective" parameterType="com.lanou.entity.Contractc">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jan 05 15:47:01 CST 2018.
    -->
    insert into CONTRACT_HIS_C
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="CONTRACT_ID != null">
        CONTRACT_ID,
      </if>
      <if test="OFFEROR != null">
        OFFEROR,
      </if>
      <if test="CONTRACT_NO != null">
        CONTRACT_NO,
      </if>
      <if test="SIGNING_DATE != null">
        SIGNING_DATE,
      </if>
      <if test="INPUT_BY != null">
        INPUT_BY,
      </if>
      <if test="CHECK_BY != null">
        CHECK_BY,
      </if>
      <if test="INSPECTOR != null">
        INSPECTOR,
      </if>
      <if test="TOTAL_AMOUNT != null">
        TOTAL_AMOUNT,
      </if>
      <if test="IMPORT_NUM != null">
        IMPORT_NUM,
      </if>
      <if test="CREQUEST != null">
        CREQUEST,
      </if>
      <if test="CUSTOM_NAME != null">
        CUSTOM_NAME,
      </if>
      <if test="DELIVERY_PERIOD != null">
        DELIVERY_PERIOD,
      </if>
      <if test="SHIP_TIME != null">
        SHIP_TIME,
      </if>
      <if test="TRADE_TERMS != null">
        TRADE_TERMS,
      </if>
      <if test="REMARK != null">
        REMARK,
      </if>
      <if test="PRINT_STYLE != null">
        PRINT_STYLE,
      </if>
      <if test="OLD_STATE != null">
        OLD_STATE,
      </if>
      <if test="STATE != null">
        STATE,
      </if>
      <if test="OUT_STATE != null">
        OUT_STATE,
      </if>
      <if test="CREATE_BY != null">
        CREATE_BY,
      </if>
      <if test="CREATE_DEPT != null">
        CREATE_DEPT,
      </if>
      <if test="CREATE_TIME != null">
        CREATE_TIME,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="CONTRACT_ID != null">
        #{CONTRACT_ID,jdbcType=VARCHAR},
      </if>
      <if test="OFFEROR != null">
        #{OFFEROR,jdbcType=VARCHAR},
      </if>
      <if test="CONTRACT_NO != null">
        #{CONTRACT_NO,jdbcType=VARCHAR},
      </if>
      <if test="SIGNING_DATE != null">
        #{SIGNING_DATE,jdbcType=TIMESTAMP},
      </if>
      <if test="INPUT_BY != null">
        #{INPUT_BY,jdbcType=VARCHAR},
      </if>
      <if test="CHECK_BY != null">
        #{CHECK_BY,jdbcType=VARCHAR},
      </if>
      <if test="INSPECTOR != null">
        #{INSPECTOR,jdbcType=VARCHAR},
      </if>
      <if test="TOTAL_AMOUNT != null">
        #{TOTAL_AMOUNT,jdbcType=DECIMAL},
      </if>
      <if test="IMPORT_NUM != null">
        #{IMPORT_NUM,jdbcType=DECIMAL},
      </if>
      <if test="CREQUEST != null">
        #{CREQUEST,jdbcType=VARCHAR},
      </if>
      <if test="CUSTOM_NAME != null">
        #{CUSTOM_NAME,jdbcType=VARCHAR},
      </if>
      <if test="DELIVERY_PERIOD != null">
        #{DELIVERY_PERIOD,jdbcType=TIMESTAMP},
      </if>
      <if test="SHIP_TIME != null">
        #{SHIP_TIME,jdbcType=TIMESTAMP},
      </if>
      <if test="TRADE_TERMS != null">
        #{TRADE_TERMS,jdbcType=VARCHAR},
      </if>
      <if test="REMARK != null">
        #{REMARK,jdbcType=VARCHAR},
      </if>
      <if test="PRINT_STYLE != null">
        #{PRINT_STYLE,jdbcType=CHAR},
      </if>
      <if test="OLD_STATE != null">
        #{OLD_STATE,jdbcType=DECIMAL},
      </if>
      <if test="STATE != null">
        #{STATE,jdbcType=DECIMAL},
      </if>
      <if test="OUT_STATE != null">
        #{OUT_STATE,jdbcType=DECIMAL},
      </if>
      <if test="CREATE_BY != null">
        #{CREATE_BY,jdbcType=VARCHAR},
      </if>
      <if test="CREATE_DEPT != null">
        #{CREATE_DEPT,jdbcType=VARCHAR},
      </if>
      <if test="CREATE_TIME != null">
        #{CREATE_TIME,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.lanou.entity.Contracthisc">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jan 05 15:47:01 CST 2018.
    -->
    update CONTRACT_HIS_C
    <set>
      <if test="OFFEROR != null">
        OFFEROR = #{OFFEROR,jdbcType=VARCHAR},
      </if>
      <if test="CONTRACT_NO != null">
        CONTRACT_NO = #{CONTRACT_NO,jdbcType=VARCHAR},
      </if>
      <if test="SIGNING_DATE != null">
        SIGNING_DATE = #{SIGNING_DATE,jdbcType=TIMESTAMP},
      </if>
      <if test="INPUT_BY != null">
        INPUT_BY = #{INPUT_BY,jdbcType=VARCHAR},
      </if>
      <if test="CHECK_BY != null">
        CHECK_BY = #{CHECK_BY,jdbcType=VARCHAR},
      </if>
      <if test="INSPECTOR != null">
        INSPECTOR = #{INSPECTOR,jdbcType=VARCHAR},
      </if>
      <if test="TOTAL_AMOUNT != null">
        TOTAL_AMOUNT = #{TOTAL_AMOUNT,jdbcType=DECIMAL},
      </if>
      <if test="IMPORT_NUM != null">
        IMPORT_NUM = #{IMPORT_NUM,jdbcType=DECIMAL},
      </if>
      <if test="CREQUEST != null">
        CREQUEST = #{CREQUEST,jdbcType=VARCHAR},
      </if>
      <if test="CUSTOM_NAME != null">
        CUSTOM_NAME = #{CUSTOM_NAME,jdbcType=VARCHAR},
      </if>
      <if test="DELIVERY_PERIOD != null">
        DELIVERY_PERIOD = #{DELIVERY_PERIOD,jdbcType=TIMESTAMP},
      </if>
      <if test="SHIP_TIME != null">
        SHIP_TIME = #{SHIP_TIME,jdbcType=TIMESTAMP},
      </if>
      <if test="TRADE_TERMS != null">
        TRADE_TERMS = #{TRADE_TERMS,jdbcType=VARCHAR},
      </if>
      <if test="REMARK != null">
        REMARK = #{REMARK,jdbcType=VARCHAR},
      </if>
      <if test="PRINT_STYLE != null">
        PRINT_STYLE = #{PRINT_STYLE,jdbcType=CHAR},
      </if>
      <if test="OLD_STATE != null">
        OLD_STATE = #{OLD_STATE,jdbcType=DECIMAL},
      </if>
      <if test="STATE != null">
        STATE = #{STATE,jdbcType=DECIMAL},
      </if>
      <if test="OUT_STATE != null">
        OUT_STATE = #{OUT_STATE,jdbcType=DECIMAL},
      </if>
      <if test="CREATE_BY != null">
        CREATE_BY = #{CREATE_BY,jdbcType=VARCHAR},
      </if>
      <if test="CREATE_DEPT != null">
        CREATE_DEPT = #{CREATE_DEPT,jdbcType=VARCHAR},
      </if>
      <if test="CREATE_TIME != null">
        CREATE_TIME = #{CREATE_TIME,jdbcType=TIMESTAMP},
      </if>
    </set>
    where CONTRACT_ID = #{CONTRACT_ID,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.lanou.entity.Contracthisc">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jan 05 15:47:01 CST 2018.
    -->
    update CONTRACT_HIS_C
    set OFFEROR = #{OFFEROR,jdbcType=VARCHAR},
      CONTRACT_NO = #{CONTRACT_NO,jdbcType=VARCHAR},
      SIGNING_DATE = #{SIGNING_DATE,jdbcType=TIMESTAMP},
      INPUT_BY = #{INPUT_BY,jdbcType=VARCHAR},
      CHECK_BY = #{CHECK_BY,jdbcType=VARCHAR},
      INSPECTOR = #{INSPECTOR,jdbcType=VARCHAR},
      TOTAL_AMOUNT = #{TOTAL_AMOUNT,jdbcType=DECIMAL},
      IMPORT_NUM = #{IMPORT_NUM,jdbcType=DECIMAL},
      CREQUEST = #{CREQUEST,jdbcType=VARCHAR},
      CUSTOM_NAME = #{CUSTOM_NAME,jdbcType=VARCHAR},
      DELIVERY_PERIOD = #{DELIVERY_PERIOD,jdbcType=TIMESTAMP},
      SHIP_TIME = #{SHIP_TIME,jdbcType=TIMESTAMP},
      TRADE_TERMS = #{TRADE_TERMS,jdbcType=VARCHAR},
      REMARK = #{REMARK,jdbcType=VARCHAR},
      PRINT_STYLE = #{PRINT_STYLE,jdbcType=CHAR},
      OLD_STATE = #{OLD_STATE,jdbcType=DECIMAL},
      STATE = #{STATE,jdbcType=DECIMAL},
      OUT_STATE = #{OUT_STATE,jdbcType=DECIMAL},
      CREATE_BY = #{CREATE_BY,jdbcType=VARCHAR},
      CREATE_DEPT = #{CREATE_DEPT,jdbcType=VARCHAR},
      CREATE_TIME = #{CREATE_TIME,jdbcType=TIMESTAMP}
    where CONTRACT_ID = #{CONTRACT_ID,jdbcType=VARCHAR}
  </update>
</mapper>